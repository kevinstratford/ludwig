%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  liquidcrystal.tex
%
%  For nematics, cholesterics, blue phases based on the Landau
%  de Gennes approach.
%
%  Edinburgh Soft Matter and Statistical Physics Group and
%  Edinburgh Parallel Computing Centre
%
%  Contributing authors:
%  Kevin Stratford (kevin@epcc.ed.ac.uk)
%  Davide Marenduzzo was the source of the original LC approach.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Liquid Crystals}
\label{section-lc}

\subsection{The Landau-de Gennes Approach}

\subsubsection{Tensor order parameter}

The liquid crystal order is described by a symmetric traceless tensor
$Q_{\alpha\beta}(\mathbf{r}; t)$. The largest eigenvalue and
associated eigenvector of $Q_{\alpha\beta}$ represent the magnitude
and local direction of liquid crystal molecular order. A theory based
on the tensor $Q_{\alpha\beta}$ has the advantage of being able to
describe disclinations where the local order vanishes and a director
is not defined. Readers are referred to, e.g., de Gennes and Prost
\cite{degennes-prost2002}, and Wright and Mermin \cite{wright-mermin}
for further information.

\subsubsection{Free Energy Density}

The free energy is a functional whose density
$f(Q_{\alpha\beta}, \partial_\gamma Q_{\alpha\beta})$
has bulk contributions depending on $Q_{\alpha\beta}$,
and elastic (distortion) contributions dependent on the
gradients of the order parameter
$\partial_\gamma Q_{\alpha\beta}$.

The bulk contributions are
\begin{equation}
\label{eq-lc-fed-bulk}
f(Q_{\alpha\beta}) =
{\textstyle\frac{1}{2}} A_0 (1 - \gamma / 3) Q_{\alpha\beta}^2
-{\textstyle\frac{1}{3}} A_0 \gamma Q_{\alpha\beta} Q_{\beta\pi} Q_{\pi\alpha}
+ {\textstyle\frac{1}{4}} A_0 \gamma (Q_{\alpha\beta}^2)^2.
\end{equation}
Here, $A_0$ is a constant which sets the overall energy scale; $\gamma$
is a temperature-like parameter which controls the position in the
phase diagram relative to the isotropic-nematic transition.

The bend, splay and twist distortions making up the gradient free
energy are modelled with two elastic
constants $\kappa_0$ and $\kappa_1$ as
\begin{equation}
f(\partial_\gamma Q_{\alpha\beta}) = 
{\textstyle\frac{1}{2}} \kappa_0 (\partial_\alpha Q_{\alpha\beta})^2
+ {\textstyle\frac{1}{2}} \kappa_1
(\epsilon_{\alpha\mu\nu} \partial_\mu Q_{\nu\beta} + 2q_0 Q_{\alpha\beta})^2.
\label{equation-lc-gradient-fe}
\end{equation}
Here, $\epsilon_{\alpha\mu\nu}$ is the permutation tensor and
$q_0 = 2\pi/p$ is a wavevector related to the pitch~$p$ of the
cholesteric. Setting $q_0 = 0$ permits a nematic state.
The one-constant approximation makes the simplification that
$\kappa_0 = \kappa_1 = \kappa$; the distinction between
$\kappa_0$ and $\kappa_1$ will be kept
in what follows unless otherwise stated.


\subsubsection{Molecular Field}

The molecular field $H_{\alpha\beta}$ is defined as the functional
derivative of the
free energy density with respect to the order parameter which here
gives
\begin{equation}
H_{\alpha\beta} = -\Bigg[
  \frac{\partial f(Q_{\alpha\beta})}{\partial Q_{\alpha\beta}}
- \partial_\gamma \frac{\partial f(\partial_\gamma Q_{\alpha\beta})}
{\partial Q_{\alpha\beta,\gamma}} \Bigg].
\end{equation}
In the absence of flow, the molecular field determines how the
order parameter relaxes toward equilibrium.

As the final expression for $H_{\alpha\beta}$ is somewhat complex, it
is useful to 
account for the individual terms here. First, the terms from the bulk free
energy density give rise to:
\begin{equation}
-A_0 (1 - \gamma/3) Q_{\alpha\beta} + A_0 \gamma Q_{\alpha\pi} Q_{\pi\beta}
- A_0 \gamma Q_{\pi\sigma}^2 Q_{\alpha\beta}.
\nonumber
\end{equation}
The second term in this expression
(arising from the cubic term in the free energy) is
forced to be traceless by subtracting one third of
Tr$(Q_{\alpha\pi}Q_{\pi\beta}) = Q_{\alpha\beta}^2$
so that we have
\begin{equation}
- A_0 (1 - \gamma/3) Q_{\alpha\beta}
+ A_0 \gamma (Q_{\alpha\pi} Q_{\pi\beta}
               - {\textstyle\frac{1}{3}} Q_{\pi\sigma}^2\delta_{\alpha\beta})
- A_0 \gamma Q_{\pi\sigma}^2 Q_{\alpha\beta}.
\nonumber
\end{equation}

The gradient term in $\kappa_0$, along with the first term in $\kappa_1$
arising from the expansion of the brackets in
Equation~\ref{equation-lc-gradient-fe}, give
\begin{equation}
\kappa_0 \partial_\alpha \partial_\gamma Q_{\gamma\beta}.
+
\kappa_1 \partial_\gamma
( \partial_\gamma Q_{\alpha\beta} - \partial_\alpha Q_{\gamma\beta}).
\nonumber
\end{equation}
Note that in the one constant approximation, this term collapses
to $\kappa \partial^2 Q_{\alpha\beta}$. The cross term in the expansion
of the brackets in~\ref{equation-lc-gradient-fe}, having been symmetrised,
contributes
\begin{equation}
-2\kappa_1 q_0
( \epsilon_{\alpha\mu\nu} \partial_\mu Q_{\nu\beta}
+ \epsilon_{\beta\mu\nu} \partial_\mu Q_{\nu\alpha}),
\nonumber
\end{equation}
which must again be forced to be traceless to give
\begin{equation}
-2\kappa_1 q_0 \big\{
( \epsilon_{\alpha\mu\nu} \partial_\mu Q_{\nu\beta}
+ \epsilon_{\beta\mu\nu} \partial_\mu Q_{\nu\alpha})
- {\textstyle\frac{1}{3}}( 
   \epsilon_{\pi\mu\nu} \partial_\mu Q_{\nu\pi}
  +\epsilon_{\pi\mu\nu} \partial_\mu Q_{\nu\pi} )
   \delta_{\alpha\beta} \big\}.
\nonumber
\end{equation}
The final term in is
$-4 \kappa_1 q_0^2 Q_{\alpha\beta}$. The complete expression for the molecular
field is then
\begin{eqnarray}
\label{eq-lc-h-full}
H_{\alpha\beta} &=&
- A_0 (1 - \gamma/3) Q_{\alpha\beta}
+ A_0 \gamma (Q_{\alpha\pi} Q_{\pi\beta}
               - {\textstyle\frac{1}{3}} Q_{\pi\sigma}^2\delta_{\alpha\beta})
- A_0 \gamma Q_{\pi\sigma}^2 Q_{\alpha\beta}
\nonumber\\
&&
+\kappa_0 \partial_\alpha \partial_\gamma Q_{\gamma\beta}
+
\kappa_1 \partial_\gamma
( \partial_\gamma Q_{\alpha\beta} - \partial_\alpha Q_{\gamma\beta})
\nonumber\\
&&
-2\kappa_1 q_0 \big(
( \epsilon_{\alpha\mu\nu} \partial_\mu Q_{\nu\beta}
+ \epsilon_{\beta\mu\nu} \partial_\mu Q_{\nu\alpha})
- {\textstyle\frac{1}{3}}( 
   \epsilon_{\pi\mu\nu} \partial_\mu Q_{\nu\pi}
  +\epsilon_{\pi\mu\nu} \partial_\mu Q_{\nu\pi} )
   \delta_{\alpha\beta} \big)
\nonumber\\
&& - 4 \kappa_1 q_0^2 Q_{\alpha\beta}.
\end{eqnarray}


\subsection{Surface Anchoring}

\label{section-lc-anchoring}

The preferred orientation of the liquid crystal fluid at a solid surface,
usually referred to as the surface anchoring, is relevant for both
solid walls and colloids.

\subsubsection{General boundary condition}

To impose a suitable boundary condition for the order parameter tensor
at a solid-fluid interface, we consider again the gradient terms in
the free energy
\begin{equation}
f (\partial_\gamma Q_{\alpha\beta}) = 
{\textstyle\frac{1}{2}} \kappa_0 (\partial_\beta Q_{\alpha\beta})^2
+ {\textstyle\frac{1}{2}}
 \kappa_1 (\epsilon_{\alpha\gamma\sigma} \partial_\gamma
Q_{\sigma\beta} + 2q_0 Q_{\alpha\beta})^2
\end{equation}
where we retain
two elastic constants $\kappa_0$ and $\kappa_1$;
the cholesteric pitch $p = 2\pi/q_0$.

Also relevant is a surface free energy (an area density), the exact form
of which is determined by the type of anchoring required. In general, we
expect this to depend on the order parameter, but not its gradients, so
write
\begin{equation}
f_s = f_s (Q_{\alpha\beta}, Q^0_{\alpha\beta})
\end{equation}
where $Q^0_{\alpha\beta}$ is some preferred order parameter configuration
at the surface (to be either normal or planar as discussed in the following
sections).

The boundary condition we wish to apply is derived from the Euler-Lagrange
equations, and for the fluid and surface terms gives rise to the equation
\begin{equation}
n_\gamma \frac{\partial f}{\partial Q_{\alpha\beta,\gamma}}
+ \frac{\partial f_s}{\partial Q_{\alpha\beta}} = 0,
\label{equation-lc-general-bc}
\end{equation}
where $n_\gamma$ is the outward unit normal at the surface (pointing into
the fluid). Note that the first term in the derivative of the fluid free
energy term with respect to
$Q_{\alpha\beta,\gamma}$ can be expended as
\begin{equation}
\kappa_0 n_\beta \partial_\gamma Q_{\alpha\gamma}
+ \kappa_1 n_\gamma
(\partial_\gamma Q_{\alpha\beta} - \partial_\alpha Q_{\gamma\beta})
- 2\kappa_1 q_0 n_\gamma \epsilon_{\alpha\gamma\sigma} Q_{\sigma\beta}.
\nonumber
\end{equation}
However, we should use a symmetric form (the derivative with respect to
$Q_{\beta\alpha,\gamma}$ is just as good) so we write this as:
\begin{eqnarray}
&
{\textstyle\frac{1}{2}} \kappa_0 (n_\alpha \partial_\gamma Q_{\beta\gamma}
+ n_\beta \partial_\gamma Q_{\alpha\gamma})
+ \kappa_1 n_\gamma \partial_\gamma Q_{\alpha\beta}
- {\textstyle\frac{1}{2}} \kappa_1 n_\gamma ( \partial_\alpha Q_{\gamma\beta}
+ \partial_\beta Q_{\gamma\alpha})
\nonumber
\\
&
- \kappa_1 q_0 n_\gamma (\epsilon_{\alpha\gamma\sigma} Q_{\sigma\beta}
+ \epsilon_{\beta\gamma\sigma}Q_{\sigma\alpha}).
\nonumber
\end{eqnarray}
The exact boundary condition will contain this term plus one
depending on the exact choice of the surface free energy which
describes a given anchoring condition.

\subsubsection{Normal or homeotropic anchoring}
The preferred direction of the surface order here is, as the name
suggests, normal to surface. We can write
\begin{equation}
f_s = {\textstyle\frac{1}{2}} w (Q_{\alpha\beta} - Q_{\alpha\beta}^0)^2
\end{equation}
where $w$ is a constant.
The preferred orientation $Q^0_{\alpha\beta}$ is based on the unit normal
at the surface $n_\gamma$, and is computed via the uniaxial approximation:
\begin{equation}
Q^0_{\alpha\beta}
= {\textstyle \frac{1}{2}} A (3n_\alpha n_\beta - \delta_{\alpha\beta}).
\end{equation}
The amplitude $A$ is provided by 
\begin{equation}
\label{equation-lc-amplitude}
A=\frac{2}{3}\left(\frac{1}{4}+\frac{3}{4}\sqrt{1 - \frac{8}{3\gamma}}\right).
\end{equation}
The full boundary condition for the gradient of the tensor order parameter
at the solid-fluid boundary from Equation~\ref{equation-lc-general-bc}
is then:
\begin{eqnarray}
{\textstyle\frac{1}{2}} \kappa_0 (n_\alpha \partial_\gamma Q_{\beta\gamma}
+ n_\beta \partial_\gamma Q_{\alpha\gamma})
+ \kappa_1 n_\gamma \partial_\gamma Q_{\alpha\beta}
- {\textstyle\frac{1}{2}} \kappa_1 n_\gamma ( \partial_\alpha Q_{\gamma\beta}
+ \partial_\beta Q_{\gamma\alpha})
\nonumber
\\
- \kappa_1 q_0 n_\gamma (\epsilon_{\alpha\gamma\sigma} Q_{\sigma\beta}
+ \epsilon_{\beta\gamma\sigma}Q_{\sigma\alpha})
- w(Q_{\alpha\beta} - Q_{\alpha\beta}^0) = 0.
\label{equation-lc-bc-normal}
\end{eqnarray}

\subsubsection{Planar (degenerate) anchoring}

For planar anchoring, the preferred orientation is in the local tangent
plane at the surface: this is a degenerate case as any orientation in
the plane is energetically equivalent. An appropriate boundary
condition is described by Fournier and Galatola \cite{fournier2005}
which we write as:
\begin{equation}
f_s =
{\textstyle\frac{1}{2}} w_1 (\tilde{Q}_{\alpha\beta} - \tilde{Q}^\perp_{\alpha\beta})^2
+ {\textstyle\frac{1}{2}} w_2 (\tilde{Q}_{\alpha\beta}^2 - A^2)^2.
\end{equation}
Here again, the amplitude $A$ is provided by
Equation~\ref{equation-lc-amplitude}. To compute this term we take
the local fluid order parameter $Q_{\alpha\beta}$, form the quantity
$$
\tilde{Q}_{\alpha\beta}
= Q_{\alpha\beta} + {\textstyle \frac{1}{2}A\delta_{\alpha\beta} }
$$
which is then projected onto the tangent plane via
$
\tilde{Q}^\perp_{\alpha\beta}
= P_{\alpha\gamma} \tilde{Q}_{\gamma\sigma} P_{\sigma\beta}
$
with the local surface normal entering through
$P_{\alpha\beta} = \delta_{\alpha\beta} - n_\alpha n_\beta$.
The full boundary condition resulting from
Equation~\ref{equation-lc-general-bc} is then
\begin{eqnarray}
{\textstyle\frac{1}{2}} \kappa_0 (n_\alpha \partial_\gamma Q_{\beta\gamma}
+ n_\beta \partial_\gamma Q_{\alpha\gamma})
+ \kappa_1 n_\gamma \partial_\gamma Q_{\alpha\beta}
- {\textstyle\frac{1}{2}} \kappa_1 n_\gamma ( \partial_\alpha Q_{\gamma\beta}
+ \partial_\beta Q_{\gamma\alpha})
\nonumber
\\
- \kappa_1 q_0 n_\gamma (\epsilon_{\alpha\gamma\sigma} Q_{\sigma\beta}
+ \epsilon_{\beta\gamma\sigma}Q_{\sigma\alpha})
- w_1 (\tilde{Q}_{\alpha\beta} - \tilde{Q}_{\alpha\beta}^\perp)
- 2w_2(\tilde{Q}_{\alpha\beta}^2 - A^2)\tilde{Q}_{\alpha\beta} = 0.
\label{equation-lc-bc-planar}
\end{eqnarray}



\subsection{Dynamics}

The time evolution of the orientational order parameter $Q_{\alpha\beta}$
in the presence of flow can be described by the Beris-Edwards equation
\cite{beris-edwards}.

\begin{equation}
\partial_t Q_{\alpha\beta} + \partial_\gamma (u_\gamma Q_{\alpha\beta})
+ S_{\alpha\beta}(W_{\alpha\beta}, Q_{\alpha\beta}) = \Gamma  H_{\alpha\beta}.
\label{equation-lc-beris-edwards}
\end{equation}
This relates the time rate of change of the order parameter to terms
involving advection, the response to shear
$S_{\alpha\beta}(W_{\alpha\beta},Q_{\alpha\beta})$, and the molecular
field.

The advective term involves the fluid velocity $u_\alpha$ and the shear
term involves the velocity gradient tensor
$W_{\alpha\beta}= \partial_\beta u_\alpha$. The full definition of the
shear term is:
\begin{eqnarray}
S_{\alpha\beta} (W_{\alpha\beta}, Q_{\alpha\beta})
& = 
(\xi D_{\alpha\pi} + \Omega_{\alpha\pi})
(Q_{\pi\beta} + {\textstyle \frac{1}{3}} \delta_{\pi\beta})
+
(Q_{\alpha\pi} + {\textstyle \frac{1}{3}} \delta_{\alpha\pi})
(\xi D_{\pi\beta} - \Omega_{\pi\beta})
\nonumber\\
&-
2\xi(Q_{\alpha\beta} + {\textstyle\frac{1}{3}}\delta_{\alpha\beta})
Q_{\pi\sigma}W_{\sigma\pi}
\nonumber
\end{eqnarray}
where $D_{\alpha\beta} = \frac{1}{2}(W_{\alpha\beta} + W_{\beta\alpha})$ and
 $\Omega_{\alpha\beta} = \frac{1}{2}(W_{\alpha\beta} - W_{\beta\alpha})$
are the symmetric and antisymmetric contributions to the velocity gradient
tensor and $\xi$ is a material constant representing an effective
molecular aspect ratio.


The thermodynamic contribution to the stress on the fluid can be viewed as
the sum of three parts:
\begin{equation}
\Pi_{\alpha\beta} = \sigma_{\alpha\beta} + \tau_{\alpha\beta}
-
\partial_\alpha Q_{\pi\nu}
\frac{\delta {\cal F}}{ \delta \partial_\beta Q_{\pi\nu}}
\label{equation-lc-stress}
\end{equation}
where $\sigma_{\alpha\beta}$ and $\tau_{\alpha\beta}$ are the symmetric
and antisymmetric contributions from the liquid crystal order:
\begin{equation}
\sigma_{\alpha\beta} =
-p_0 \delta_{\alpha\beta} 
- \xi H_{\alpha\pi}(Q_{\pi\beta} + {\textstyle\frac{1}{3}}\delta_{\pi\beta})
- \xi (Q_{\alpha\pi} + {\textstyle\frac{1}{3}}\delta_{\alpha\pi}) H_{\pi\beta}
+ 2\xi (Q_{\alpha\beta} + {\textstyle \frac{1}{3}}\delta_{\alpha\beta} )
Q_{\pi\nu} H_{\pi\nu},
\end{equation}
where $p_0$ is the isotropic pressure, and
\begin{equation}
\tau_{\alpha\beta} = Q_{\alpha\pi} H_{\pi\beta} - H_{\alpha\pi} Q_{\pi\beta}. 
\end{equation}
The final term in Equation~\ref{equation-lc-stress} is expanded as
$$
-\kappa_0 \partial_\alpha Q_{\pi\beta} \partial_\nu Q_{\pi\nu}
-\kappa_1 \partial_\alpha Q_{\pi\nu}
\left[ \partial_\beta Q_{\pi\nu} - \partial_\pi Q_{\nu\beta}
+ 2q_0 \epsilon_{\gamma\beta\pi} Q_{\gamma\nu} \right].
$$


\subsubsection{Active stress}

An additional term may be added to the stress to model an active
apolar fluid. This term is
\begin{equation}
\Pi_{\alpha\beta}^a = -\zeta
(Q_{\alpha\beta} - {\textstyle\frac{1}{3}}\delta_{\alpha\beta})
\end{equation}
where $\zeta$ is an activity parameter: $\zeta < 0$ gives
contractile behaviour and $\zeta > 0$ gives extensile behaviour.

\subsection{Implementation}

\subsubsection{Fluid}

The time evolution of the order parameter is computed by a hybrid
approach where the hydrodynamics is in the LB sector, and the
Beris-Edwards Equation is solved in a finite difference approach.
The hydrodynamic quantities and the order parameter share the same
regular lattice. The velocity field, computed via LB, supplies
advective fluxes and the velocity gradient tensor using an appropriate
finite difference stencil.

Coupling to the Navier-Stokes equations is via a body force computed
locally at each lattice site via the divergence of the stress in
Equation~\ref{equation-lc-stress}.

It is also possible to compute solely relaxational dynamics where there
is no flow, and evolution only depends on the molecular field, and the
rotational diffusion constant.


\subsubsection{Solid}

First, we note that the assignment of solid and fluid lattice
nodes for the order parameter follows that for the density:
inside and outside are distinguished using the nominal radius
of the colloid $a_0$ and its position. It is useful, in addition,
to think about a series of control volumes surrounding each lattice
node whose faces are aligned with the lattice
(see Figure~\ref{figure-lc-hybrid}). A set of these
faces constitute the solid-fluid boundary in the hybrid picture.
Advective fluxes of order parameter are computed at the faces
of the control volumes, and the boundary condition is zero
normal flux at solid-fluid interfaces. Note that the colloid
is assumed to be stationary in assigning these fluxes.

\begin{figure}[h]
\begin{center}
\input{figures/hybrid.tex}
\end{center}
\caption{The hybrid picture. In the lattice
Boltzmann picture (left) a surface is defined by a set of links
$f_b$, which involve discrete vectors $\mathbf{c}_b \Delta t$ which
connect fluid and solid sites. For the order parameter (right), the
colloid is represented by the set of faces, e.g., that between sites
$i,j$ and $i+1,j$ with unit normal $\hat{n}_x$. This is a rather small
colloid.}
\label{figure-lc-hybrid}
\end{figure}

The net hydrodynamic force on the colloid is computed via BBL
in the usual way. As discussed above, the force on the fluid
originating from the order parameter is computed via the
discrete divergence of the stress $\Pi_{\alpha\beta}$. In the
fluid, this is implemented by interpolating $\Pi_{\alpha\beta}$
to the control volume faces and taking differences between faces
in each direction. This method has the advantage that, with the
introduction of solid faces, an extrapolation of $\Pi_{\alpha\beta}$
to the solid-fluid boundary is possible. This allows one to compute
the divergence of the stress at fluid nodes adjacent to the colloid
in the normal way. At the same time, the discrete equivalent of
\begin{equation}
F_\alpha^\mathrm{coll} = \int \Pi_{\alpha\beta} \hat{n}_\beta dS
\end{equation}
may be found by summing $\Pi_{\alpha\beta}$ over the relevant solid-fluid
control volume faces. By construction, this ensures that momentum lost by
the fluid is gained by the colloid, i.e., global momentum is
conserved.

Finally, movement of the colloid across the lattice is accompanied
by changes in its discrete shape. When fluid sites are destroyed,
corresponding order parameter information is also lost. If new
fluid sites are created, new order parameter information may be
added locally either by interpolation from nearby fluid sites, or
from geometrical information from the local surface anchoring.


\subsubsection{Boundary conditions}

\begin{table}[t]
\centering
\tabcolsep=4pt
\begin{tabular}{|c|cccccc|}
\hline
&
$Q_{xx,x}$ & $Q_{xy,x}$ & $Q_{xz,x}$ & $Q_{yy,x}$ & $Q_{yz,x}$ & $Q_{zz,x}$\\
\hline
$Q_{xx}$ &
$\kappa_0 n_x$ & $-\kappa_1 n_y$ & $-\kappa_1 n_z$ & & &\\
$Q_{xy}$ &
$\kappa_0 n_y$ & $\kappa' n_x$ & & $-\kappa_1 n_y$  & $-\kappa_1 n_z$ & \\
$Q_{xz}$ &
$\kappa_0 n_z$ & & $\kappa' n_x$ & & $-\kappa_1 n_y$ &$ -\kappa_1 n_z$\\
$Q_{yy}$ &
 & $\kappa_0 n_y$ & & $\kappa_1 n_x$ & &\\
$Q_{yz}$ &
 & $\kappa_0 n_z$ & $\kappa_0 n_y$ & & $2\kappa_1 n_x$ & \\
$Q_{zz}$ &
 & & $\kappa_0 n_z$ & & & $\kappa_1 n_x$\\
\hline
\hline
&
$Q_{xx,y}$ & $Q_{xy,y}$ & $Q_{xz,y}$ & $Q_{yy,y}$ & $Q_{yz,y}$ & $Q_{zz,y}$\\
\hline
$Q_{xx}$ &
$\kappa_1 n_y$ & $\kappa_0 n_x$ & & & &\\
$Q_{xy}$ &
$-\kappa_1 n_x$ & $\kappa' n_y$ & $-\kappa_1 n_z$ & $\kappa_0 n_x$ & &\\
$Q_{xz}$ &
 & $\kappa_0 n_z$ & $2\kappa_1 n_y$ & & $\kappa_0 n_x$ & \\
$Q_{yy}$ &
 & $-\kappa_1 n_x$ & & $\kappa_0 n_y$ & $-\kappa_1 n_z$ & \\
$Q_{yz}$ &
 & & $-\kappa_1 n_x$ & $\kappa_0 n_z$ & $\kappa' n_y$ & $-\kappa_1 n_z$\\
$Q_{zz}$ &
 & & & & $\kappa_0 n_z$ & $\kappa_1 n_y$\\
\hline
\hline
&
$Q_{xx,z}$ & $Q_{xy,z}$ & $Q_{xz,z}$ & $Q_{yy,z}$ & $Q_{yz,z}$ & $Q_{zz,z}$\\
\hline
$Q_{xx}$ &
$\kappa_1 n_z$ & & $\kappa_0 n_x$ & & & \\
$Q_{xy}$ &
 & $2\kappa_1 n_z$ & $\kappa_0 n_y$ & & $\kappa_0 n_x$ & \\
$Q_{xz}$ &
$-\kappa_1 n_x$ & $-\kappa_1 n_y$ & $\kappa' n_z$ & & & $\kappa_0 n_x$  \\
$Q_{yy}$ &
 & & & $\kappa_1 n_z$ & $\kappa_0 n_y$ & \\
$Q_{yz}$ &
 & $-\kappa_1 n_x$ & & $-\kappa_1 n_y$ & $\kappa' n_z$ & $\kappa_0 n_y$ \\
$Q_{zz}$ &
 & & $-\kappa_1 n_x$ & & $-\kappa_1 n_y $ & $\kappa_0 n_z$\\
\hline
\end{tabular}
\caption{Coefficients of the various derivatives of the order parameter
tensor appearing in six equations for the elements of the
order parameter (including $Q_{zz}$).
Note $\kappa_0 + \kappa_1 = \kappa'$ and all the
coefficients have been multiplied by a factor of 2 in the off-diagonal
equations.}
\label{table-lc-bc}
\end{table} 


In three dimensions, the boundary condition Eq.~\ref{equation-lc-general-bc}
provides six equations containing (potentially) 18 unknown derivatives
$\partial_\gamma Q_{\alpha\beta}$
corresponding to the 6 elements of the order parameter
tensor $Q_{xx}$, $Q_{xy}$, $Q_{xz}$, $Q_{yy}$, $Q_{yz}$, $Q_{zz}$.
While the equation corresponding to $Q_{zz}$ must appear to
retain isotropy, $Q_{zz}$ itself, and its derivatives, may be
replaced via the
constraint on the trace of $Q_{\alpha\beta}$. We can therefore either
solve a fully determined system including $Q_{zz}$, and then impose
tracelessness on the result, or replace $Q_{zz}$ and solve six
equations for five unknowns, with the sixth equation acting as the
constraint. These methods provide the same answer for cases where
the surface normal is along the coordinate directions.

In general, Equation~\ref{equation-lc-general-bc} is slightly
cumbersome: the coefficients of the various derivatives for each
of the six equations are shown in Table~\ref{table-lc-bc}. As an
concrete example,
at a flat surface with normal anchoring and, e.g., $n = (1, 0, 0)$,
the number of unknowns (six) are the gradients $\partial_x Q_{\alpha\beta}$
at the boundary --- we assume the tangential gradients
$\partial_y Q_{\alpha\beta}$
and $\partial_z Q_{\alpha\beta}$ can be approximated
using the standard differencing method involving only fluid values of
$Q_{\alpha\beta}$. We proceed by
computing the constant terms relevant for normal anchoring
$$
- \kappa_1 q_0 n_\gamma (\epsilon_{\alpha\gamma\sigma} Q_{\sigma\beta}
+ \epsilon_{\beta\gamma\sigma}Q_{\sigma\alpha})
- w(Q_{\alpha\beta} - Q_{\alpha\beta}^0)
$$
using $Q_{\alpha\beta}$ from the adjacent fluid site. To these
constant terms are added the tangential gradients.
The gradients at the surface are then computed by solving a 6x6
linear algebra problem for $\partial_x Q_{\alpha\beta}$. This
allows the full gradient at the adjacent fluid site to be constructed.

At concave edges or corners, where it is not possible to compute the
tangential gradients from the usual stencil as for a flat interface,
a different approach is required. Here, either a 12$\times$12 or
18$\times$18 system of equations is solved containing the relevant
unknown coefficients from Table~\ref{table-lc-bc} and the relevant
constant terms computed as before.





\vfill
\pagebreak
